function out = stage_cost_gen(dt,xi,vtr,Q,R)
xi1=xi(1);xi2=xi(2);vtr1=vtr(1);
q11=Q(1,1);q12=Q(1,2);q21=Q(2,1);q22=Q(2,2);r11=R(1,1);
out=(1/20).*dt.^5.*q11.*vtr1.^2+(1/8).*dt.^4.*q12.*vtr1.^2+(1/8).*dt.^4.* ...
  q21.*vtr1.^2+(1/3).*dt.^3.*q22.*vtr1.^2+dt.*r11.*vtr1.^2+(1/3).*dt.^3.* ...
  q11.*vtr1.*xi1+(1/2).*dt.^2.*q12.*vtr1.*xi1+(1/2).*dt.^2.*q21.*vtr1.* ...
  xi1+dt.*q11.*xi1.^2+(1/4).*dt.^4.*q11.*vtr1.*xi2+(1/2).*dt.^3.*q12.* ...
  vtr1.*xi2+(1/2).*dt.^3.*q21.*vtr1.*xi2+dt.^2.*q22.*vtr1.*xi2+dt.^2.* ...
  q11.*xi1.*xi2+dt.*q12.*xi1.*xi2+dt.*q21.*xi1.*xi2+(1/3).*dt.^3.*q11.* ...
  xi2.^2+(1/2).*dt.^2.*q12.*xi2.^2+(1/2).*dt.^2.*q21.*xi2.^2+dt.*q22.* ...
  xi2.^2;
